#!/bin/bash

output_file="klipper_devices.cfg"
devices="/dev/serial/by-id/*"

echo "# Klipper Mainsail Device Configuration" > "$output_file"
echo "# Auto-generated by script on $(date)" >> "$output_file"
echo "" >> "$output_file"

for device in $devices; do
    echo "[mcu]" >> "$output_file"
    echo "serial: $device" >> "$output_file"
    echo  "restart_method: command" >> "$output_file"
    echo "" >> "$output_file"
done

echo "Device configuration has been written to $output_file."
